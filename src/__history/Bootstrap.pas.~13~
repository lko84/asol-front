unit Bootstrap;

interface

uses Spring.Container, Services.Interfaces, Services.AuthService, Services.UserService, Services.OrderService, FrameHost, UserListFrame, UserDetailFrame, OrderListFrame, OrderDetailFrame, FrameRegistry;

procedure Initialize;
procedure RegisterServices;
procedure RegisterFrames(FrameRegistry: TFrameRegistry);
procedure RegistryBuild;

implementation

procedure Initialize;
begin
  RegisterServices;
  RegistryBuild;
end;

procedure RegisterServices;
begin
  GlobalContainer.RegisterType<IAuthService, TAuthService>.AsSingleton;
  GlobalContainer.RegisterType<IUserService, TUserService>.AsSingleton;
  GlobalContainer.RegisterType<IOrderService, TOrderService>.AsSingleton;

  var FrameRegistry := TFrameRegistry.Create;
  GlobalContainer.RegisterType<TFrameRegistry, TFrameRegistry>.AsSingleton(FrameRegistry);

  RegisterFrames(FrameRegistry);
end;

procedure RegisterFrames(FrameRegistry: TFrameRegistry);
begin
  FrameRegistry.Register<TUserList>('U001', 'U001: Users');
  FrameRegistry.Register<TUserDetail>('U002', 'U002: User Detail');
  FrameRegistry.Register<TOrderList>('O001', 'O001: Orders');
  FrameRegistry.Register<TOrderDetail>('O002', 'O002: Order Detail');
end;

procedure RegistryBuild;
begin
  GlobalContainer.Build;
end;

end.
